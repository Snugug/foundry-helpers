{"_id":"8hC63OyskyQqC0iI","name":"#[CF_tempEntity]","type":"chat","author":"iFx5GYPtMbNPrxol","img":"icons/svg/dice-target.svg","scope":"global","command":"","folder":null,"sort":0,"permission":{"default":0,"iFx5GYPtMbNPrxol":3},"flags":{"cf":{"id":"temp_i4354fhwfaf","folderPath":[],"color":"#000000","fontColor":"#FFFFFF","name":"Moulinette Macros","children":[],"icon":""}}}
{"_id":"Nzh7pMpm5TIDSCVC","name":"Add Moulinette Sources","type":"script","author":"iFx5GYPtMbNPrxol","img":"icons/svg/dice-target.svg","scope":"global","command":"if (game.moulinette) {\n  // Possible sources:\n  // User Data => data\n  // Core Data => public\n  // The Bazaar => forge-bazaar\n  // My Asset Library => forgevtt\n\n  const sources = [\n    { type: 'images', publisher: 'Systems', pack: 'DnD 5e Icons', source: 'data', path: 'systems/dnd5e/icons' },\n  ];\n\n  const customSources = sources.map((s) => s.path);\n  game.moulinette.sources = game.moulinette.sources.filter((s) => !customSources.includes(s.path));\n\n  game.moulinette.sources = game.moulinette.sources.concat(sources).flat();\n  ui.notifications.info('Sources added!');\n}","folder":null,"sort":0,"permission":{"default":0,"iFx5GYPtMbNPrxol":3},"flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_i4354fhwfaf"}}}
{"_id":"W4GFGet35gZtXERf","name":"#[CF_tempEntity]","type":"chat","author":"iFx5GYPtMbNPrxol","img":"icons/svg/dice-target.svg","scope":"global","command":"","folder":null,"sort":0,"permission":{"default":0,"iFx5GYPtMbNPrxol":3},"flags":{"cf":{"id":"temp_0hlroutcj0tl","folderPath":[],"color":"#000000","fontColor":"#FFFFFF","name":"Active Tile Macros","children":[],"icon":""}}}
{"_id":"cHBba0UXQMkvbCSK","name":"#[CF_tempEntity]","type":"chat","author":"iFx5GYPtMbNPrxol","img":"icons/svg/dice-target.svg","scope":"global","command":"","folder":null,"sort":0,"permission":{"default":0,"iFx5GYPtMbNPrxol":3},"flags":{"cf":{"id":"temp_odxhesr2hu","folderPath":[],"color":"#000000","fontColor":"#FFFFFF","name":"Combat Utility Belt Macros","children":[],"icon":""}}}
{"_id":"dxYb9XKLDivdrV6M","name":"Tiered Difficulty Check","type":"script","author":"iFx5GYPtMbNPrxol","img":"icons/svg/dice-target.svg","scope":"global","command":"/**\n * Tiered Difficulty Check\n * @param {string[]} options - Arguments to the macro to determine anchors. Allowed values are:\n *   - x - A single number\n *   - x-y - A range where the number is greater to or equal to x and less than or equal to y\n *   - <x - Any number less than x\n *   - <=x - Any number less than or equal to x\n *   - >x - Any number greater than x\n *   - >=x - Any number greater than or equal to x\n *   - crit-success|crit(ical) - Roll the highest die face\n *   - crit(ical)-fail(ure)|fumble - Roll the lowest die face\n * Example input:\n *   >=18 >15 10-15 crit fumble\n *   This will create the following anchors:\n *     check >= 18  - All tokens that rolled an 18 or higher\n *     check > 15   - All tokens that rolled higher than a 15\n *     check 10-15  - All tokens that rolled a 10 or higher, but less than or equal to 15\n *     check crit   - All tokens that rolled the highest die face\n *     check fumble - All tokens that rolled the lowest die face\n */\nconst results = arguments[0].value.tokenresults;\nconst options = arguments[0].args;\n\n// Associate tokens with their rolls\nconst actors = await Promise.all(\n  results.map(async (r) => ({\n    roll: {\n      total: r.roll.total,\n      dice: r.roll.terms[0].results.find((r) => r.active)?.result,\n      options: r.roll.terms[0].options,\n    },\n    token: await fromUuid(r.uuid),\n  })),\n);\n\n// Determine anchors for each token\nconst goto = options\n  .map((opt) => {\n    // If it's a number, use it directly\n    const r = {\n      anchor: opt,\n    };\n\n    if (!isNaN(opt) || /^\\d+$/.test(opt)) {\n      r.min = parseInt(opt);\n      r.max = parseInt(opt) + 1;\n    } else if (/^\\d+-\\d+$/.test(opt)) {\n      const [min, max] = opt.split('-');\n      r.min = parseInt(min);\n      r.max = parseInt(max) + 1;\n    } else if (/^<\\d+$/.test(opt)) {\n      r.min = -Infinity;\n      r.max = parseInt(opt.slice(1));\n    } else if (/^>\\d+$/.test(opt)) {\n      r.min = parseInt(opt.slice(1)) + 1;\n      r.max = Infinity;\n    } else if (/^<=\\d+$/.test(opt)) {\n      r.min = -Infinity;\n      r.max = parseInt(opt.slice(2)) + 1;\n    } else if (/^>=\\d+$/.test(opt)) {\n      r.min = parseInt(opt.slice(2));\n      r.max = Infinity;\n    } else if (/^crit(ical)?(-success)?$/.test(opt)) {\n      r.option = 'critical';\n    } else if (/^(crit(ical)?-fail(ure)?|fumble)$/.test(opt)) {\n      r.option = 'fumble';\n    } else {\n      return null;\n    }\n\n    return r;\n  })\n  .filter((r) => r)\n  .map((range) => ({\n    tag: `check ${range.anchor}`,\n    tokens: actors\n      .filter((a) => {\n        if (range.option) {\n          return a.roll.options[range.option] === a.roll.dice;\n        } else {\n          return a.roll.total >= range.min && a.roll.total < range.max;\n        }\n      })\n      .map((a) => a.token),\n  }))\n  .filter((r) => r.tokens.length);\n\nreturn { goto };","folder":null,"sort":0,"permission":{"default":0,"iFx5GYPtMbNPrxol":3},"flags":{"combat-utility-belt":{"macroTrigger":""},"core":{"sourceId":"Macro.dxYb9XKLDivdrV6M"},"cf":{"id":"temp_0hlroutcj0tl"}}}
{"_id":"qawToGYkwwLpbRtp","name":"CUBImmobile","type":"script","author":"iFx5GYPtMbNPrxol","img":"icons/svg/dice-target.svg","scope":"global","command":"const setter = 'Immobile';\nconst lookups = ['Paralyzed', 'Petrified', 'Stunned', 'Exhaustion 5', 'Grappled', 'Restrained', 'Unconscious'];\n\nconst label = args[1].efData.label;\nconst switcher = args[0];\n\nif (switcher === 'on') {\n  await game.cub.addCondition(setter);\n} else {\n  const conditions = game.cub\n    .getConditions()\n    .conditions.map((c) => c.name)\n    .filter((c) => c !== setter);\n  let stillSet = false;\n\n  for (const c of conditions) {\n    if (lookups.includes(c)) {\n      stillSet = true;\n    }\n  }\n\n  if (stillSet === false) {\n    await game.cub.removeCondition(setter);\n  }\n}","folder":null,"sort":0,"permission":{"default":0,"iFx5GYPtMbNPrxol":3},"flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_odxhesr2hu"}}}
{"_id":"rXAsxIkGGu1a5hYl","name":"CUBIncapacitated","type":"script","author":"iFx5GYPtMbNPrxol","img":"icons/svg/dice-target.svg","scope":"global","command":"const setter = 'Incapacitated';\nconst lookups = ['Paralyzed', 'Petrified', 'Stunned', 'Unconscious'];\n\nconst label = args[1].efData.label;\nconst switcher = args[0];\n\nif (switcher === 'on') {\n  await game.cub.addCondition(setter);\n} else {\n  const conditions = game.cub\n    .getConditions()\n    .conditions.map((c) => c.name)\n    .filter((c) => c !== setter);\n  let stillSet = false;\n\n  for (const c of conditions) {\n    if (lookups.includes(c)) {\n      stillSet = true;\n    }\n  }\n\n  if (stillSet === false) {\n    await game.cub.removeCondition(setter);\n  }\n}","folder":null,"sort":0,"permission":{"default":0,"iFx5GYPtMbNPrxol":3},"flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_odxhesr2hu"}}}
{"name":"CUBTieredConditions","type":"chat","author":"iFx5GYPtMbNPrxol","img":"icons/svg/dice-target.svg","scope":"global","command":"// Set up tiered conditions\nconst immobile = game.SnugugsLittleHelpers\n  .applyCondition('Immobile')\n  .to([\n    'Paralyzed',\n    'Petrified',\n    'Stunned',\n    'Exhaustion 5',\n    'Grappled',\n    'Restrained',\n    'Unconscious',\n  ]);\nconst incapacitated = game.SnugugsLittleHelpers\n  .applyCondition('Incapacitated')\n  .to([\n    'Paralyzed',\n    'Petrified',\n    'Stunned',\n    'Unconscious',\n  ]);\n\n// Get the current conditions\nconst condition = args[1].efData.label;\nconst switcher = args[0];\n\n// Check the conditions\nawait immobile(condition, switcher);\nawait incapacitated(condition, switcher);","folder":null,"sort":0,"permission":{"default":0,"iFx5GYPtMbNPrxol":3},"flags":{"combat-utility-belt":{"macroTrigger":""},"advanced-macros":{"runAsGM":false},"core":{"sourceId":"Macro.d4aFOKE2b6UkLmBC"}},"_id":"U3MczrGDYte7ZE8q"}
{"_id":"U3MczrGDYte7ZE8q","name":"CUBTieredConditions","type":"chat","author":"iFx5GYPtMbNPrxol","img":"icons/svg/dice-target.svg","scope":"global","command":"// Set up tiered conditions\nconst immobile = game.SnugugsLittleHelpers\n  .applyCondition('Immobile')\n  .to([\n    'Paralyzed',\n    'Petrified',\n    'Stunned',\n    'Exhaustion 5',\n    'Grappled',\n    'Restrained',\n    'Unconscious',\n  ]);\nconst incapacitated = game.SnugugsLittleHelpers\n  .applyCondition('Incapacitated')\n  .to([\n    'Paralyzed',\n    'Petrified',\n    'Stunned',\n    'Unconscious',\n  ]);\n\n// Get the current conditions\nconst condition = args[1].efData.label;\nconst switcher = args[0];\n\n// Check the conditions\nawait immobile(condition, switcher);\nawait incapacitated(condition, switcher);","folder":null,"sort":0,"permission":{"default":0,"iFx5GYPtMbNPrxol":3},"flags":{"combat-utility-belt":{"macroTrigger":""},"advanced-macros":{"runAsGM":false},"core":{"sourceId":"Macro.d4aFOKE2b6UkLmBC"},"cf":{"id":"temp_odxhesr2hu"}}}
{"$$deleted":true,"_id":"qawToGYkwwLpbRtp"}
{"$$deleted":true,"_id":"rXAsxIkGGu1a5hYl"}
{"$$deleted":true,"_id":"U3MczrGDYte7ZE8q"}
{"name":"CUBTieredConditions","type":"script","author":"iFx5GYPtMbNPrxol","img":"icons/svg/dice-target.svg","scope":"global","command":"// Set up tiered conditions\nconst immobile = game.SnugugsLittleHelpers\n  .applyCondition('Immobile')\n  .to([\n    'Paralyzed',\n    'Petrified',\n    'Stunned',\n    'Exhaustion 5',\n    'Grappled',\n    'Restrained',\n    'Unconscious',\n  ]);\nconst incapacitated = game.SnugugsLittleHelpers\n  .applyCondition('Incapacitated')\n  .to([\n    'Paralyzed',\n    'Petrified',\n    'Stunned',\n    'Unconscious',\n  ]);\n\n// Get the current conditions\nconst condition = args[1].efData.label;\nconst switcher = args[0];\n\n// Check the conditions\nawait immobile(condition, switcher);\nawait incapacitated(condition, switcher);","folder":null,"sort":0,"permission":{"default":0,"iFx5GYPtMbNPrxol":3},"flags":{"combat-utility-belt":{"macroTrigger":""},"advanced-macros":{"runAsGM":false},"core":{"sourceId":"Macro.d4aFOKE2b6UkLmBC"},"cf":null},"_id":"6nBFOc3AeELmT7QS"}
{"_id":"6nBFOc3AeELmT7QS","name":"CUBTieredConditions","type":"script","author":"iFx5GYPtMbNPrxol","img":"icons/svg/dice-target.svg","scope":"global","command":"// Set up tiered conditions\nconst immobile = game.SnugugsLittleHelpers\n  .applyCondition('Immobile')\n  .to([\n    'Paralyzed',\n    'Petrified',\n    'Stunned',\n    'Exhaustion 5',\n    'Grappled',\n    'Restrained',\n    'Unconscious',\n  ]);\nconst incapacitated = game.SnugugsLittleHelpers\n  .applyCondition('Incapacitated')\n  .to([\n    'Paralyzed',\n    'Petrified',\n    'Stunned',\n    'Unconscious',\n  ]);\n\n// Get the current conditions\nconst condition = args[1].efData.label;\nconst switcher = args[0];\n\n// Check the conditions\nawait immobile(condition, switcher);\nawait incapacitated(condition, switcher);","folder":null,"sort":0,"permission":{"default":0,"iFx5GYPtMbNPrxol":3},"flags":{"combat-utility-belt":{"macroTrigger":""},"advanced-macros":{"runAsGM":false},"core":{"sourceId":"Macro.d4aFOKE2b6UkLmBC"},"cf":{"id":"temp_odxhesr2hu"}}}
{"_id":"6nBFOc3AeELmT7QS","name":"CUBTieredConditions","type":"script","author":"iFx5GYPtMbNPrxol","img":"icons/svg/dice-target.svg","scope":"global","command":"// Set up tiered conditions\nconst immobile = game.SnugugsLittleHelpers\n  .applyCondition('Immobile')\n  .to([\n    'Paralyzed',\n    'Petrified',\n    'Stunned',\n    'Exhaustion 5',\n    'Grappled',\n    'Restrained',\n    'Unconscious',\n  ]);\nconst incapacitated = game.SnugugsLittleHelpers\n  .applyCondition('Incapacitated')\n  .to([\n    'Paralyzed',\n    'Petrified',\n    'Stunned',\n    'Unconscious',\n  ]);\n\n// Get the current conditions\nconst condition = args[1].efData.label;\nconst toggle = args[0];\n\n// Check the conditions\nawait immobile(condition, toggle);\nawait incapacitated(condition, toggle);","folder":null,"sort":0,"permission":{"default":0,"iFx5GYPtMbNPrxol":3},"flags":{"combat-utility-belt":{"macroTrigger":""},"advanced-macros":{"runAsGM":false},"core":{"sourceId":"Macro.d4aFOKE2b6UkLmBC"},"cf":{"id":"temp_odxhesr2hu"}}}
{"_id":"6nBFOc3AeELmT7QS","name":"CUBTieredConditions","type":"script","author":"iFx5GYPtMbNPrxol","img":"icons/svg/dice-target.svg","scope":"global","command":"// Set up tiered conditions\ngame.SnugugsLittleHelpers\n  .applyCondition('Immobile')\n  .to([\n    'Paralyzed',\n    'Petrified',\n    'Stunned',\n    'Exhaustion 5',\n    'Grappled',\n    'Restrained',\n    'Unconscious',\n  ]);\ngame.SnugugsLittleHelpers\n  .applyCondition('Incapacitated')\n  .to([\n    'Paralyzed',\n    'Petrified',\n    'Stunned',\n    'Unconscious',\n  ]);","folder":null,"sort":0,"permission":{"default":0,"iFx5GYPtMbNPrxol":3},"flags":{"combat-utility-belt":{"macroTrigger":""},"advanced-macros":{"runAsGM":false},"core":{"sourceId":"Macro.d4aFOKE2b6UkLmBC"},"cf":{"id":"temp_odxhesr2hu"}}}
{"_id":"6nBFOc3AeELmT7QS","name":"Tiered Conditions","type":"script","author":"iFx5GYPtMbNPrxol","img":"icons/svg/dice-target.svg","scope":"global","command":"// Set up tiered conditions\ngame.SnugugsLittleHelpers\n  .applyCondition('Immobile')\n  .to([\n    'Paralyzed',\n    'Petrified',\n    'Stunned',\n    'Exhaustion 5',\n    'Grappled',\n    'Restrained',\n    'Unconscious',\n  ]);\ngame.SnugugsLittleHelpers\n  .applyCondition('Incapacitated')\n  .to([\n    'Paralyzed',\n    'Petrified',\n    'Stunned',\n    'Unconscious',\n  ]);","folder":null,"sort":0,"permission":{"default":0,"iFx5GYPtMbNPrxol":3},"flags":{"combat-utility-belt":{"macroTrigger":""},"advanced-macros":{"runAsGM":false},"core":{"sourceId":"Macro.d4aFOKE2b6UkLmBC"},"cf":{"id":"temp_odxhesr2hu"}}}
{"_id":"6nBFOc3AeELmT7QS","name":"Stacked Conditions","type":"script","author":"iFx5GYPtMbNPrxol","img":"icons/svg/dice-target.svg","scope":"global","command":"// Set up stacked conditions\ngame.SnugugsLittleHelpers\n  .applyCondition('Immobile')\n  .to([\n    'Paralyzed',\n    'Petrified',\n    'Stunned',\n    'Exhaustion 5',\n    'Grappled',\n    'Restrained',\n    'Unconscious',\n  ]);\ngame.SnugugsLittleHelpers\n  .applyCondition('Incapacitated')\n  .to([\n    'Paralyzed',\n    'Petrified',\n    'Stunned',\n    'Unconscious',\n  ]);","folder":null,"sort":0,"permission":{"default":0,"iFx5GYPtMbNPrxol":3},"flags":{"combat-utility-belt":{"macroTrigger":""},"advanced-macros":{"runAsGM":false},"core":{"sourceId":"Macro.d4aFOKE2b6UkLmBC"},"cf":{"id":"temp_odxhesr2hu"}}}
{"name":"Reset Stacked Conditions","type":"script","author":"iFx5GYPtMbNPrxol","img":"icons/svg/dice-target.svg","scope":"global","command":"game.SnugugsLittleHelpers.resetStackedConditions()","folder":null,"sort":0,"permission":{"default":0,"iFx5GYPtMbNPrxol":3},"flags":{"combat-utility-belt":{"macroTrigger":""},"core":{"sourceId":"Macro.RMt7ojIAc6MKFsyw"}},"_id":"cS5AWi2c7fmkKSHr"}
{"_id":"cS5AWi2c7fmkKSHr","name":"Reset Stacked Conditions","type":"script","author":"iFx5GYPtMbNPrxol","img":"icons/svg/dice-target.svg","scope":"global","command":"game.SnugugsLittleHelpers.resetStackedConditions()","folder":null,"sort":0,"permission":{"default":0,"iFx5GYPtMbNPrxol":3},"flags":{"combat-utility-belt":{"macroTrigger":""},"core":{"sourceId":"Macro.RMt7ojIAc6MKFsyw"},"cf":{"id":"temp_odxhesr2hu"}}}
{"_id":"6nBFOc3AeELmT7QS","name":"Add Stacked Conditions","type":"script","author":"iFx5GYPtMbNPrxol","img":"icons/svg/dice-target.svg","scope":"global","command":"// Set up stacked conditions\ngame.SnugugsLittleHelpers\n  .applyCondition('Immobile')\n  .to([\n    'Paralyzed',\n    'Petrified',\n    'Stunned',\n    'Exhaustion 5',\n    'Grappled',\n    'Restrained',\n    'Unconscious',\n  ]);\ngame.SnugugsLittleHelpers\n  .applyCondition('Incapacitated')\n  .to([\n    'Paralyzed',\n    'Petrified',\n    'Stunned',\n    'Unconscious',\n  ]);","folder":null,"sort":0,"permission":{"default":0,"iFx5GYPtMbNPrxol":3},"flags":{"combat-utility-belt":{"macroTrigger":""},"advanced-macros":{"runAsGM":false},"core":{"sourceId":"Macro.d4aFOKE2b6UkLmBC"},"cf":{"id":"temp_odxhesr2hu"}}}
